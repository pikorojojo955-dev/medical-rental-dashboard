<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <title>‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤ ¬∑ JP Medical So Supply</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body {
      font-family: "TH SarabunPSK", system-ui, sans-serif;
      margin: 0;
      padding: 8px;
      background: #f5f5f5;
    }

    .page {
      max-width: 960px;
      margin: 0 auto;
      background: #fff;
      padding: 16px 22px 24px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      border: 2px solid #0ea5e9;
    }

    .top-bar {
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      justify-content:space-between;
      align-items:center;
      margin-bottom:8px;
      font-size:0.9rem;
    }

    .top-buttons {
      display:flex;
      flex-wrap:wrap;
      gap:8px;
    }

    .btn {
      padding:4px 12px;
      border-radius:20px;
      border:none;
      cursor:pointer;
      font-size:0.9rem;
      font-family:inherit;
      display:inline-flex;
      align-items:center;
      gap:6px;
      white-space:nowrap;
    }

    .btn-back { background:#6b7280; color:#fff; }
    .btn-print { background:#0ea5e9; color:#fff; }

    select {
      padding:4px 8px;
      border-radius:6px;
      border:1px solid #d4d4d8;
      font-size:0.9rem;
      min-width:210px;
    }

    h1 {
      text-align:center;
      margin:4px 0 2px;
      font-size:1.8rem;
    }

    h2 {
      text-align:center;
      margin:0 0 12px;
      font-size:1.1rem;
      font-weight:400;
    }

    .shop-name {
      text-align:center;
      font-size:1rem;
      margin-bottom:4px;
      font-weight:700;
    }

    .shop-sub {
      text-align:center;
      font-size:0.9rem;
      margin-bottom:12px;
    }

    .row {
      display:flex;
      justify-content:space-between;
      gap:16px;
      font-size:0.9rem;
      margin-bottom:6px;
    }

    .block {
      flex:1;
      border:1px solid #d4d4d8;
      border-radius:8px;
      padding:6px 10px;
    }

    .block-title {
      font-weight:bold;
      margin-bottom:4px;
      font-size:0.95rem;
    }

    .editable {
      border-bottom:1px dotted #666;
      min-width:80px;
      display:inline-block;
      padding:0 2px;
    }

    table {
      width:100%;
      border-collapse:collapse;
      font-size:0.9rem;
      margin-top:10px;
    }

    th, td {
      border:1px solid #444;
      padding:3px 5px;
      vertical-align:top;
    }

    th {
      background:#e0f2fe;
      text-align:center;
    }

    .text-right { text-align:right; }

    .cell-input {
      width:100%;
      border:none;
      padding:2px 3px;
      font-family:inherit;
      font-size:0.9rem;
      box-sizing:border-box;
    }

    .cell-input:focus {
      outline:1px solid #0ea5e9;
      background:#eff6ff;
    }

    /* ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤ */
    .summary-wrapper {
      margin-top:6px;
      display:flex;
      justify-content:flex-end;
    }

    .summary-table {
      border-collapse:collapse;
      font-size:0.9rem;
      min-width:260px;
    }

    .summary-table th,
    .summary-table td {
      border:1px solid #444;
      padding:2px 5px;
      white-space:nowrap;
    }

    .summary-table th {
      background:#f1f5f9;
      text-align:left;
    }

    .sum-input {
      width:100%;
      text-align:right;
      border:none;
      padding:0 2px;
      font-family:inherit;
      font-size:0.9rem;
    }

    .sum-input[readonly] {
      background:#f9fafb;
    }

    /* ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏≤‡∏ó‡∏ñ‡πâ‡∏ß‡∏ô */
    .amount-words-box {
      border:1px solid #444;
      margin-top:6px;
      padding:6px 10px;
      text-align:center;
      font-size:1rem;
      font-weight:bold;
    }

    /* ‡∏™‡πà‡∏ß‡∏ô‡∏•‡πà‡∏≤‡∏á ‚Äì ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ã‡πâ‡∏≤‡∏¢/‡∏Ç‡∏ß‡∏≤ */
    .bottom-row {
      display:flex;
      gap:12px;
      margin-top:10px;
      font-size:0.9rem;
    }

    .bottom-left,
    .bottom-right {
      flex:1;
      border:1px solid #444;
      padding:8px 10px 14px;
      box-sizing:border-box;
    }

    .bottom-left-title {
      text-align:center;
      margin-bottom:4px;
    }

    .bottom-left-sub {
      text-align:center;
      font-size:0.8rem;
      margin-bottom:12px;
    }

    .sign-line {
      margin-top:16px;
      margin-bottom:2px;
      text-align:center;
    }

    .sign-line span {
      display:inline-block;
      border-bottom:1px solid #444;
      min-width:160px;
      height:18px;
    }

    .sign-caption {
      text-align:center;
      font-size:0.85rem;
    }

    .small-center {
      text-align:center;
      font-size:0.85rem;
    }

    @media print {
      body { background:#fff; padding:0; }
      .page { box-shadow:none; margin:0; border:none; }
      .top-bar { display:none; }
      @page { size:A4 portrait; margin:10mm; }
    }
  </style>
</head>
<body>
<div class="page">

  <!-- ‡πÅ‡∏ñ‡∏ö‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô -->
  <div class="top-bar">
    <div class="top-buttons">
      <a href="./ky9.html">
        <button class="btn btn-back">‚Üê ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (‡∏Ç‡∏¢.9)</button>
      </a>
      <button class="btn btn-print" onclick="window.print()">üñ® ‡∏û‡∏¥‡∏°‡∏û‡πå / PDF</button>
    </div>
    <div>
      ‡∏™‡∏≤‡∏Ç‡∏≤:
      <select id="branchSelect">
        <option value="chonburi">‡∏™‡∏≤‡∏Ç‡∏≤ ‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ</option>
        <option value="branch2">‡∏™‡∏≤‡∏Ç‡∏≤ 2 (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ)</option>
      </select>
    </div>
  </div>

  <!-- ‡∏´‡∏±‡∏ß‡∏ü‡∏≠‡∏£‡πå‡∏° -->
  <div class="shop-name" id="shopName">
    ‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÄ‡∏à‡∏û‡∏µ‡πÄ‡∏°‡∏î‡∏¥‡∏Ñ‡∏≠‡∏•‡πÇ‡∏ã ‡∏ã‡∏±‡∏û‡∏û‡∏•‡∏≤‡∏¢ ‡∏™‡∏≤‡∏Ç‡∏≤ ‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ
  </div>
  <div class="shop-sub" id="shopAddress">
    51/49 ‡∏ñ‡∏ô‡∏ô‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó ‡∏´‡∏°‡∏π‡πà 4 ‡∏ï.‡∏ö‡πâ‡∏≤‡∏ô‡∏™‡∏ß‡∏ô ‡∏≠.‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏à.‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ 20000 ‡πÇ‡∏ó‡∏£. 090-413-7894, 090-967-4207
  </div>

  <h1>QUOTATION</h1>
  <h2>‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤</h2>

  <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ / ‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤ -->
  <div class="row">
    <div class="block">
      <div class="block-title">‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (Customer)</div>
      ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö: <span class="editable" contenteditable="true">..............................................</span><br>
      ‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô / ‡∏£‡πâ‡∏≤‡∏ô: <span class="editable" contenteditable="true">..............................................</span><br>
      ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà: <span class="editable" contenteditable="true">.................................................................</span><br>
      ‡πÇ‡∏ó‡∏£: <span class="editable" contenteditable="true">.......................</span>
    </div>
    <div class="block">
      <div class="block-title">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤</div>
      ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤: <span class="editable" contenteditable="true">QT-....../......</span><br>
      ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: <span class="editable" contenteditable="true">.... / .... / ....</span><br>
      ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: <span class="editable" contenteditable="true">.... / .... / ....</span><br>
      ‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠: <span class="editable" contenteditable="true">................................</span><br>
      ‡πÇ‡∏ó‡∏£: <span class="editable" contenteditable="true">098-444-1614</span>
    </div>
  </div>

  <!-- datalist Item Code -->
  <datalist id="itemCodeList"></datalist>

  <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
  <table>
    <thead>
      <tr>
        <th style="width:40px;">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
        <th style="width:100px;">Item Code</th>
        <th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
        <th style="width:70px;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
        <th style="width:70px;">‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
        <th style="width:90px;">‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
        <th style="width:100px;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</th>
      </tr>
    </thead>
    <tbody id="itemBody">
      <!-- ‡πÅ‡∏ñ‡∏ß‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢ JS -->
    </tbody>
  </table>

  <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤ -->
  <div class="summary-wrapper">
    <table class="summary-table">
      <tr>
        <th>‡∏£‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</th>
        <td><input id="sumSubtotal" class="sum-input" type="number" readonly></td>
      </tr>
      <tr>
        <th>‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î</th>
        <td><input id="sumDiscount" class="sum-input" type="number" value="0"></td>
      </tr>
      <tr>
        <th>‡∏´‡∏±‡∏Å ‡πÄ‡∏á‡∏¥‡∏ô‡∏°‡∏±‡∏î‡∏à‡∏≥</th>
        <td><input id="sumDeposit" class="sum-input" type="number" value="0"></td>
      </tr>
      <tr>
        <th>‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
        <td class="small-center">
          <input id="sumRemain" class="sum-input" type="number" readonly>
        </td>
      </tr>
      <tr>
        <th><strong>‡∏£‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô</strong></th>
        <td><input id="sumTotal" class="sum-input" type="number" readonly></td>
      </tr>
    </table>
  </div>

  <!-- ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏≤‡∏ó‡∏ñ‡πâ‡∏ß‡∏ô -->
  <div class="amount-words-box">
    <span class="editable" contenteditable="true" id="amountWords">
      ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏≤‡∏ó‡∏ñ‡πâ‡∏ß‡∏ô
    </span>
  </div>

  <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏•‡πà‡∏≤‡∏á ‚Äì ‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠ -->
  <div class="bottom-row">
    <!-- ‡∏ã‡πâ‡∏≤‡∏¢: ‡∏ú‡∏π‡πâ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ -->
    <div class="bottom-left">
      <div class="bottom-left-title">
        ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ã‡πá‡∏ô‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ï‡∏≤‡∏°‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ
      </div>
      <div class="bottom-left-sub">
        Please sign below purchasing confirmation.
      </div>

      <div class="sign-line">
        <span></span>
      </div>
      <div class="small-center">
        ( <span class="editable" contenteditable="true">........................................</span> )
      </div>
      <div class="sign-caption">
        ‡∏ú‡∏π‡πâ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠
      </div>
    </div>

    <!-- ‡∏Ç‡∏ß‡∏≤: ‡∏ú‡∏π‡πâ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ -->
    <div class="bottom-right">
      <div class="bottom-left-title">
        ‡∏Ç‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏±‡∏ö‡∏ñ‡∏∑‡∏≠
      </div>
      <div class="small-center">
        JP Medical So Supply
      </div>

      <div class="sign-line" style="margin-top:24px;">
        <span></span>
      </div>
      <div class="small-center">
        <span class="editable" contenteditable="true">
          ‡∏Ñ‡∏∏‡∏ì‡∏û‡∏±‡∏í‡∏ô‡πå‡∏ô‡∏£‡∏µ ‡πÄ‡∏ö‡∏≠‡∏£‡πå 090-967-4207
        </span>
      </div>
      <div class="sign-caption">
        ‡∏ú‡∏π‡πâ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ / Prepared by
      </div>
    </div>
  </div>

</div>

<script>
/* ============================
   1) CONFIG GOOGLE SHEET ITEM
   ============================ */

const ITEM_SPREADSHEET_ID = "1U4d5PqBMQ1GfTahwvbvzDFQrEikT5sYCOwZIx8FabMI";
const ITEM_GID = "942187814";
const ITEM_URL =
  `https://docs.google.com/spreadsheets/d/${ITEM_SPREADSHEET_ID}/gviz/tq?tqx=out:json&gid=${ITEM_GID}`;

let allItems = [];
let branch = "chonburi";

/* ‡∏õ‡∏£‡∏±‡∏ö index ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ä‡∏µ‡∏ï‡∏à‡∏£‡∏¥‡∏á‡∏ñ‡πâ‡∏≤‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô */
function parseItemRow(row) {
  const c = row.c || [];
  return {
    code: (c[0]?.v || "").toString(),
    name: (c[1]?.v || "").toString(),
    unit: (c[2]?.v || "").toString(),
    price: Number(c[3]?.v ?? 0)
  };
}

function loadItemsFromSheet() {
  fetch(ITEM_URL)
    .then(res => res.text())
    .then(txt => {
      const jsonStr = txt.substring(txt.indexOf("{"), txt.lastIndexOf("}") + 1);
      const data = JSON.parse(jsonStr);
      const rows = data.table.rows || [];
      allItems = rows.map(parseItemRow).filter(it => it.code || it.name);
      buildItemCodeDatalist();
    })
    .catch(err => {
      console.error("‡πÇ‡∏´‡∏•‡∏î Item ‡∏à‡∏≤‡∏Å‡∏ä‡∏µ‡∏ï‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:", err);
    });
}

function buildItemCodeDatalist() {
  const dl = document.getElementById("itemCodeList");
  dl.innerHTML = "";
  allItems.forEach(it => {
    const opt = document.createElement("option");
    opt.value = it.code;
    opt.label = `${it.code} : ${it.name}`;
    dl.appendChild(opt);
  });
}

function findItemByCode(code) {
  if (!code) return null;
  const c = code.trim().toLowerCase();
  return allItems.find(it => it.code.toLowerCase() === c) || null;
}

/* ============================
   2) ‡πÅ‡∏ñ‡∏ß‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
   ============================ */

const itemBody = document.getElementById("itemBody");

function createItemRow(index) {
  const tr = document.createElement("tr");
  tr.innerHTML = `
    <td class="text-right">${index}</td>
    <td><input list="itemCodeList" class="cell-input cell-code"></td>
    <td><input class="cell-input cell-desc"></td>
    <td><input class="cell-input cell-qty" type="number" min="0" step="0.01"></td>
    <td><input class="cell-input cell-unit"></td>
    <td><input class="cell-input cell-price" type="number" min="0" step="0.01"></td>
    <td><input class="cell-input cell-amount" type="number" step="0.01" readonly></td>
  `;
  attachRowEvents(tr);
  return tr;
}

function buildInitialRows(count = 10) {
  itemBody.innerHTML = "";
  for (let i = 1; i <= count; i++) {
    itemBody.appendChild(createItemRow(i));
  }
}

/* ============================
   3) ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì
   ============================ */

const sumSubtotal = document.getElementById("sumSubtotal");
const sumDiscount = document.getElementById("sumDiscount");
const sumDeposit  = document.getElementById("sumDeposit");
const sumRemain   = document.getElementById("sumRemain");
const sumTotal    = document.getElementById("sumTotal");

function parseNumber(val) {
  if (typeof val !== "string") val = String(val ?? "");
  val = val.replace(/,/g, "");
  const n = parseFloat(val);
  return isNaN(n) ? 0 : n;
}

function recalcRowAmount(tr) {
  const qtyInput = tr.querySelector(".cell-qty");
  const priceInput = tr.querySelector(".cell-price");
  const amountInput = tr.querySelector(".cell-amount");
  const qty = parseNumber(qtyInput.value);
  const price = parseNumber(priceInput.value);
  const amount = qty * price;
  amountInput.value = amount ? amount.toFixed(2) : "";
}

function recalcTotals() {
  let subtotal = 0;
  const rows = itemBody.querySelectorAll("tr");
  rows.forEach(tr => {
    const amountInput = tr.querySelector(".cell-amount");
    const val = parseNumber(amountInput.value);
    subtotal += val;
  });
  const discount = parseNumber(sumDiscount.value);
  const deposit  = parseNumber(sumDeposit.value);

  const remain = subtotal - discount - deposit;
  const total  = remain;

  sumSubtotal.value = subtotal ? subtotal.toFixed(2) : "";
  sumRemain.value   = remain ? remain.toFixed(2)   : "";
  sumTotal.value    = total ? total.toFixed(2)     : "";
}

/* ============================
   4) Event ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏ñ‡∏ß
   ============================ */

function attachRowEvents(tr) {
  const codeInput   = tr.querySelector(".cell-code");
  const descInput   = tr.querySelector(".cell-desc");
  const unitInput   = tr.querySelector(".cell-unit");
  const priceInput  = tr.querySelector(".cell-price");
  const qtyInput    = tr.querySelector(".cell-qty");

  codeInput.addEventListener("change", () => {
    const item = findItemByCode(codeInput.value);
    if (item) {
      descInput.value = item.name;
      unitInput.value = item.unit;
      priceInput.value = item.price ? item.price.toFixed(2) : "";
      recalcRowAmount(tr);
      recalcTotals();
    }
  });

  [qtyInput, priceInput].forEach(inp => {
    inp.addEventListener("input", () => {
      recalcRowAmount(tr);
      recalcTotals();
    });
  });
}

/* ============================
   5) ‡∏™‡∏≤‡∏Ç‡∏≤
   ============================ */

const BRANCHES = {
  chonburi: {
    name: "‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÄ‡∏à‡∏û‡∏µ‡πÄ‡∏°‡∏î‡∏¥‡∏Ñ‡∏≠‡∏•‡πÇ‡∏ã ‡∏ã‡∏±‡∏û‡∏û‡∏•‡∏≤‡∏¢ ‡∏™‡∏≤‡∏Ç‡∏≤ ‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ",
    address: "51/49 ‡∏ñ‡∏ô‡∏ô‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó ‡∏´‡∏°‡∏π‡πà 4 ‡∏ï.‡∏ö‡πâ‡∏≤‡∏ô‡∏™‡∏ß‡∏ô ‡∏≠.‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏à.‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ 20000 ‡πÇ‡∏ó‡∏£. 090-413-7894, 090-967-4207"
  },
  branch2: {
    name: "‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÄ‡∏à‡∏û‡∏µ‡πÄ‡∏°‡∏î‡∏¥‡∏Ñ‡∏≠‡∏•‡πÇ‡∏ã ‡∏ã‡∏±‡∏û‡∏û‡∏•‡∏≤‡∏¢ ‡∏™‡∏≤‡∏Ç‡∏≤ 2",
    address: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏µ‡πâ‡∏ï‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á ‡πÇ‡∏ó‡∏£. ................."
  }
};

const shopNameEl = document.getElementById("shopName");
const shopAddressEl = document.getElementById("shopAddress");
const branchSelect = document.getElementById("branchSelect");

function applyBranch(b) {
  branch = b;
  const info = BRANCHES[b] || BRANCHES.chonburi;
  shopNameEl.textContent = info.name;
  shopAddressEl.textContent = info.address;
}

branchSelect.addEventListener("change", (e) => {
  applyBranch(e.target.value);
});

/* ============================
   6) ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î/‡∏°‡∏±‡∏î‡∏à‡∏≥ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô ‚Üí ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏´‡∏°‡πà
   ============================ */

[sumDiscount, sumDeposit].forEach(inp => {
  inp.addEventListener("input", () => {
    recalcTotals();
  });
});

/* ============================
   7) init
   ============================ */

applyBranch("chonburi");
buildInitialRows(10);
loadItemsFromSheet();
</script>
</body>
</html>
