<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <title>‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô ¬∑ JP Medical So Supply</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body {
      font-family: "TH SarabunPSK", system-ui, sans-serif;
      margin:0;
      padding:8px;
      background:#f5f5f5;
    }
    .page {
      max-width:1150px;
      margin:0 auto;
      background:#fff;
      padding:12px 18px 24px;
      box-shadow:0 2px 6px rgba(0,0,0,0.08);
    }
    .top-bar {
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      margin-bottom:8px;
      flex-wrap:wrap;
    }
    .btn {
      padding:6px 14px;
      border-radius:30px;
      font-size:0.9rem;
      font-weight:600;
      cursor:pointer;
      border:none;
      color:#fff;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:6px;
      box-shadow:0 2px 4px rgba(0,0,0,0.2);
    }
    .btn-back  { background:#607d8b; }
    .btn-print { background:#ff9800; }

    .doc-header {
      display:flex;
      align-items:flex-start;
      gap:16px;
      border:1px solid #000;
      padding:8px 10px;
    }
    .logo-box img {
      max-width:110px;
      height:auto;
    }
    .header-main {
      flex:1;
      text-align:center;
      line-height:1.35;
    }
    .header-main h1 {
      margin:0;
      font-size:1.5rem;
      font-weight:bold;
    }
    .header-main .sub {
      font-size:1.05rem;
    }
    .branch-block {
      text-align:right;
      font-size:0.95rem;
      min-width:230px;
    }
    .branch-line { white-space:pre-line; }
    .branch-select-row {
      margin-top:4px;
      display:flex;
      justify-content:flex-end;
      gap:4px;
      align-items:center;
      font-size:0.9rem;
    }
    .branch-select-row select {
      font-family:inherit;
      font-size:0.9rem;
      padding:2px 6px;
    }

    .info-row {
      display:flex;
      gap:8px;
      margin-top:6px;
    }
    .info-box {
      flex:1;
      border:1px solid #000;
      padding:6px 8px;
      font-size:0.95rem;
    }
    .info-title {
      font-weight:bold;
      margin-bottom:4px;
    }
    .info-grid {
      display:grid;
      grid-template-columns:110px 1fr;
      row-gap:2px;
    }
    .info-grid label { display:block; }
    .info-grid input {
      width:100%;
      border:none;
      border-bottom:1px dotted #555;
      font-family:inherit;
      font-size:0.95rem;
      padding:0 2px;
      outline:none;
    }

    .meta-grid {
      display:grid;
      grid-template-columns:120px 1fr;
      row-gap:2px;
    }
    .meta-grid input {
      width:100%;
      border:none;
      border-bottom:1px dotted #555;
      font-family:inherit;
      font-size:0.95rem;
      padding:0 2px;
      outline:none;
    }

    .table-wrapper {
      margin-top:8px;
      border:1px solid #000;
      border-top:none;
    }
    table {
      width:100%;
      border-collapse:collapse;
      font-size:0.95rem;
    }
    th, td {
      border:1px solid #000;
      padding:2px 4px;
      vertical-align:top;
    }
    thead th {
      text-align:center;
      background:#00c853;
      color:#fff;
    }
    .number-cell { text-align:center; width:40px; }
    .itemcode-cell { width:130px; }
    .desc-cell   { width:320px; }
    .qty-cell    { width:70px; text-align:center; }
    .unit-cell   { width:80px; text-align:center; }
    .price-cell  { width:110px; text-align:right; }
    .amount-cell { width:120px; text-align:right; }

    .cell-input {
      width:100%;
      border:none;
      font-family:inherit;
      font-size:0.95rem;
      padding:0 2px;
      outline:none;
      box-sizing:border-box;
    }
    .cell-input.center { text-align:center; }
    .cell-input.number { text-align:right; }

    .desc-print {
      display:none;
      white-space:normal;
      line-height:1.1;
      max-height:2.4em;
      overflow:hidden;
    }

    .summary-row {
      display:flex;
      border-left:1px solid #000;
      border-right:1px solid #000;
      border-bottom:1px solid #000;
    }
    .summary-left {
      flex:1;
      border-right:1px solid #000;
      min-height:90px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:1.2rem;
    }
    .summary-left span[contenteditable] {
      border-bottom:1px dotted #555;
      padding:0 4px;
      min-width:120px;
      display:inline-block;
      text-align:center;
    }

    .summary-right {
      width:230px;
    }
    .summary-right table {
      width:100%;
      border-collapse:collapse;
      font-size:0.95rem;
    }
    .summary-right td {
      border-left:1px solid #000;
      border-right:1px solid #000;
      border-bottom:1px solid #000;
      padding:2px 4px;
    }

    .footer-block {
      border:1px solid #000;
      border-top:none;
      padding:8px 10px 12px;
      font-size:0.95rem;
      display:grid;
      grid-template-columns:1.4fr 1fr;
      gap:8px;
    }
    @media print {
  .print-page {
    page-break-after: always;
  }
  .print-page:last-child {
    page-break-after: auto;
  }
}
@media print {
  .print-page {
    page-break-after: always;
  }
  .print-page:last-child {
    page-break-after: auto;
  }
}

  </style>
</head>

<body>

<!-- datalist ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
<datalist id="productList"></datalist>

<!-- ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ -->
<div class="page" id="editPage">
  <div class="top-bar">
    <a href="./Quotation.html" class="btn btn-back">‚Üê ‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤</a>
    <button class="btn btn-print" onclick="window.print()">üñ® ‡∏û‡∏¥‡∏°‡∏û‡πå / PDF</button>
  </div>

  <div class="doc-header">
    <div class="logo-box">
      <img src="./LOGO.jpg" alt="JP Medical So Supply Logo">
    </div>
    <div class="header-main">
      <h1>QUOTATION</h1>
      <div class="sub">‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤</div>
    </div>
    <div class="branch-block">
      <div><strong>‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå JP Medical So Supply</strong></div>
      <div id="branchInfo" class="branch-line"></div>
      <div class="branch-select-row">
        <label for="branchSelect">‡∏™‡∏≤‡∏Ç‡∏≤:</label>
        <select id="branchSelect">
          <option value="ssk">‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏ç‡πà (‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©)</option>
          <option value="chon">‡∏™‡∏≤‡∏Ç‡∏≤ ‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ</option>
        </select>
      </div>
    </div>
  </div>

  <!-- CUSTOMER + META -->
  <div class="info-row">
    <div class="info-box">
      <div class="info-title">‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤ (Customer)</div>
      <div class="info-grid">
        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö:</label>
        <input id="qtCustName" type="text" />
        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô / ‡∏£‡πâ‡∏≤‡∏ô:</label>
        <input id="qtCustOrg" type="text" />
        <label>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</label>
        <input id="qtCustAddr" type="text" />
        <label>‡πÇ‡∏ó‡∏£:</label>
        <input id="qtCustTel" type="text" />
      </div>
    </div>
    <div class="info-box">
      <div class="info-title">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤</div>
      <div class="meta-grid">
        <label>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤:</label>
        <input id="qtNo" type="text" />
        <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label>
        <input id="qtDate" type="text" />
        <label>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô:</label>
        <input id="qtPayment" type="text" placeholder="‡πÇ‡∏≠‡∏ô / ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î / ‡∏≠‡∏∑‡πà‡∏ô‡πÜ" />
        <label>‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥:</label>
        <input id="qtMaker" type="text" value="JP Medical So Supply" />
      </div>
    </div>
  </div>

  <!-- TABLE -->
  <div class="table-wrapper">
    <table>
      <thead>
        <tr>
          <th class="number-cell">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
          <th class="itemcode-cell">Item Code</th>
          <th class="desc-cell">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
          <th class="qty-cell">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
          <th class="unit-cell">‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
          <th class="price-cell">‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
          <th class="amount-cell">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</th>
        </tr>
      </thead>

      <tbody id="itemBody"></tbody>
    </table>
  </div>

  <!-- SUMMARY -->
  <div class="summary-row">
    <div class="summary-left">
      ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£):
      <span id="amountWords" contenteditable="true">‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏≤‡∏ó‡∏ñ‡πâ‡∏ß‡∏ô</span>
    </div>
    <div class="summary-right">
      <table>
        <tr>
          <td class="label">‡∏£‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</td>
          <td class="value"><input id="sumSubTotal" type="text" value="0.00"></td>
        </tr>
        <tr>
          <td class="label">‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î</td>
          <td class="value"><input id="sumDiscount" type="text" value="0.00"></td>
        </tr>
        <tr>
          <td class="label">VAT 7%</td>
          <td class="value"><input id="sumVat" type="text" value="0.00"></td>
        </tr>
        <tr>
          <td class="label"><strong>‡∏¢‡∏≠‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</strong></td>
          <td class="value"><input id="sumGrand" type="text" value="0.00"></td>
        </tr>
      </table>
    </div>
  </div>

  <!-- FOOTER -->
  <div class="footer-block">
    <div class="footer-left">
      <p><strong>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤:</strong></p>
      <p>1. ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡∏µ‡πâ‡∏£‡∏ß‡∏°‡∏†‡∏≤‡∏©‡∏µ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß / ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏° (‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏≠‡∏á)</p>
      <p>2. ‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏≠‡∏≤‡∏¢‡∏∏ 7 ‡∏ß‡∏±‡∏ô</p>
      <p>3. ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏Ñ‡∏≤ ‡∏Å‡πà‡∏≠‡∏ô‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</p>
    </div>
    <div class="footer-right">
      <div>‡∏Ç‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏±‡∏ö‡∏ñ‡∏∑‡∏≠<br>JP Medical So Supply</div>
      <img src="./ORCODE%20OFFice.png" alt="Line QR">
      <div class="footer-note">‡∏™‡πÅ‡∏Å‡∏ô QR ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏≠‡∏î‡πÑ‡∏•‡∏ô‡πå / ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°</div>
    </div>
  </div>

</div> <!-- end page -->

<!-- PRINT container -->
<div id="printContainer"></div>


<!-- ========== START SCRIPT ========== -->
<script>

const STORAGE_KEY = "JP_LAST_QUOTATION";

const PAGE_SIZE = 10;
const MAX_ROWS = 30;
let ROW_COUNT = MAX_ROWS;

/* ======================================================
   ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ñ‡∏ß‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (30 ‡πÅ‡∏ñ‡∏ß‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç)
====================================================== */
function buildItemRows(count = MAX_ROWS) {
  ROW_COUNT = count;
  const tbody = document.getElementById("itemBody");
  tbody.innerHTML = "";

  for (let i = 0; i < count; i++) {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td class="number-cell">
        <input class="cell-input center" id="idx_${i}" value="${i + 1}">
      </td>
      <td class="itemcode-cell">
        <input class="cell-input" id="code_${i}">
      </td>
      <td class="desc-cell">
        <input list="productList" class="cell-input" id="desc_${i}">
        <div class="desc-print" id="desc_print_${i}"></div>
      </td>
      <td class="qty-cell">
        <input class="cell-input center" id="qty_${i}" type="number" min="0" value="">
      </td>
      <td class="unit-cell">
        <input class="cell-input center" id="unit_${i}">
      </td>
      <td class="price-cell">
        <input class="cell-input number" id="price_${i}" type="number" step="0.01">
      </td>
      <td class="amount-cell">
        <input class="cell-input number" id="amount_${i}" type="number" step="0.01">
      </td>
    `;
    tbody.appendChild(tr);
  }
}

/* ======================================================
   Convert number ‚Üí Thai text
====================================================== */
function numberToThaiBahtText(amount) {
  amount = parseFloat(amount);
  if (isNaN(amount) || amount === 0) return "‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏≤‡∏ó‡∏ñ‡πâ‡∏ß‡∏ô";

  const thNum  = ["‡∏®‡∏π‡∏ô‡∏¢‡πå","‡∏´‡∏ô‡∏∂‡πà‡∏á","‡∏™‡∏≠‡∏á","‡∏™‡∏≤‡∏°","‡∏™‡∏µ‡πà","‡∏´‡πâ‡∏≤","‡∏´‡∏Å","‡πÄ‡∏à‡πá‡∏î","‡πÅ‡∏õ‡∏î","‡πÄ‡∏Å‡πâ‡∏≤"];
  const thUnit = ["","‡∏™‡∏¥‡∏ö","‡∏£‡πâ‡∏≠‡∏¢","‡∏û‡∏±‡∏ô","‡∏´‡∏°‡∏∑‡πà‡∏ô","‡πÅ‡∏™‡∏ô","‡∏•‡πâ‡∏≤‡∏ô"];

  function readNumber(numStr) {
    numStr = numStr.replace(/^0+/, "");
    if (numStr === "") return "";

    if (numStr.length > 6) {
      return readNumber(numStr.slice(0, -6)) + "‡∏•‡πâ‡∏≤‡∏ô" + readNumber(numStr.slice(-6));
    }

    let text = "";
    const digits = numStr.split("").map(n => parseInt(n, 10));
    const len = digits.length;

    for (let i = 0; i < len; i++) {
      const d = digits[i];
      const pos = len - i - 1;

      if (d === 0) continue;
      if (pos === 0) {
        text += (d === 1 && len > 1) ? "‡πÄ‡∏≠‡πá‡∏î" : thNum[d];
      } else if (pos === 1) {
        if (d === 1) text += "‡∏™‡∏¥‡∏ö";
        else if (d === 2) text += "‡∏¢‡∏µ‡πà‡∏™‡∏¥‡∏ö";
        else text += thNum[d] + "‡∏™‡∏¥‡∏ö";
      } else {
        text += thNum[d] + thUnit[pos];
      }
    }
    return text;
  }

  const fixed = amount.toFixed(2);
  const [baht, satang] = fixed.split(".");
  let result = "";

  if (parseInt(baht,10) > 0) result += readNumber(baht) + "‡∏ö‡∏≤‡∏ó";
  if (parseInt(satang,10) === 0) result += "‡∏ñ‡πâ‡∏ß‡∏ô";
  else result += readNumber(satang) + "‡∏™‡∏ï‡∏≤‡∏á‡∏Ñ‡πå";

  return result;
}

function parseMoney(str) {
  const n = parseFloat((str || "0").replace(/,/g, ""));
  return isNaN(n) ? 0 : n;
}

/* ======================================================
   ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°
====================================================== */
function recalcTotals() {
  let subtotal = 0;

  for (let i = 0; i < ROW_COUNT; i++) {
    const qty = parseFloat(document.getElementById(`qty_${i}`).value) || 0;
    const price = parseFloat(document.getElementById(`price_${i}`).value) || 0;
    const amount = qty * price;

    document.getElementById(`amount_${i}`).value = amount.toFixed(2);
    subtotal += amount;
  }

  document.getElementById("sumSubTotal").value = subtotal.toFixed(2);
  const discount = parseMoney(document.getElementById("sumDiscount").value);
  const vat = subtotal * 0.07;

  document.getElementById("sumVat").value = vat.toFixed(2);
  const grand = subtotal - discount + vat;

  document.getElementById("sumGrand").value = grand.toFixed(2);
  document.getElementById("amountWords").textContent = numberToThaiBahtText(grand);
}

/* ======================================================
   Sync description text for print
====================================================== */
function syncDescPrint(row) {
  document.getElementById(`desc_print_${row}`).textContent =
    document.getElementById(`desc_${row}`).value || "";
}

function syncAllDescPrint() {
  for (let i = 0; i < ROW_COUNT; i++) syncDescPrint(i);
}

/* ======================================================
   Prepare input value attributes for print
====================================================== */
function syncInputAttributes() {
  document.querySelectorAll("#editPage input")
    .forEach(i => i.setAttribute("value", i.value));
}

/* ======================================================
   ‚≠ê‚≠ê‚≠ê  Multi-page print (10 ‡πÅ‡∏ñ‡∏ß/‡∏´‡∏ô‡πâ‡∏≤) ‚Äì ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
====================================================== */
function buildPrintPages() {

  recalcTotals();
  syncAllDescPrint();
  syncInputAttributes();

  const printContainer = document.getElementById("printContainer");
  printContainer.innerHTML = "";

  const editPage = document.getElementById("editPage");

  // --------------------------
  // ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á
  // --------------------------
  let filledRows = [];
  for (let i = 0; i < ROW_COUNT; i++) {
    const desc = document.getElementById(`desc_${i}`).value.trim();
    const amount = document.getElementById(`amount_${i}`).value.trim();
    if (desc || amount) filledRows.push(i);
  }

  if (filledRows.length === 0) filledRows = [0];

  const totalPages = Math.ceil(filledRows.length / PAGE_SIZE);

  // --------------------------
  // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏û‡∏à
  // --------------------------
  for (let p = 0; p < totalPages; p++) {
    const page = editPage.cloneNode(true);
    page.classList.add("print-page");
    page.id = "";

    const tbody = page.querySelector("#itemBody");
    const allRows = [...tbody.querySelectorAll("tr")];

    // ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡πÅ‡∏ñ‡∏ß‡πÄ‡∏î‡∏¥‡∏°‡∏≠‡∏≠‡∏Å
    tbody.innerHTML = "";

    // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ä‡πà‡∏ß‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
    const start = p * PAGE_SIZE;
    const end = start + PAGE_SIZE;

    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á
    filledRows.slice(start, end).forEach(idx => {
      tbody.appendChild(allRows[idx].cloneNode(true));
    });

    // ‡πÄ‡∏ï‡∏¥‡∏°‡πÅ‡∏ñ‡∏ß‡∏ß‡πà‡∏≤‡∏á‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö 10 ‡πÅ‡∏ñ‡∏ß
    while (tbody.querySelectorAll("tr").length < PAGE_SIZE) {
      const empty = document.createElement("tr");
      empty.innerHTML = `
        <td class="number-cell"></td>
        <td class="itemcode-cell"></td>
        <td class="desc-cell"></td>
        <td class="qty-cell"></td>
        <td class="unit-cell"></td>
        <td class="price-cell"></td>
        <td class="amount-cell"></td>
      `;
      tbody.appendChild(empty);
    }

    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤
    const pn = page.querySelector(".page-number");
    if (pn) pn.textContent = `‡∏´‡∏ô‡πâ‡∏≤ ${p + 1}/${totalPages}`;

    printContainer.appendChild(page);
  }
}

/* ======================================================
   ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏´‡∏•‡∏±‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå
====================================================== */
function cleanupPrintPages() {
  document.getElementById("printContainer").innerHTML = "";
}

/* ======================================================
   START
====================================================== */
document.addEventListener("DOMContentLoaded", () => {

  buildItemRows();

  // summary calc
  document.getElementById("sumDiscount").addEventListener("input", recalcTotals);

  // setup date
  const t = new Date();
  document.getElementById("qtDate").value =
    `${String(t.getDate()).padStart(2,"0")}/${String(t.getMonth()+1).padStart(2,"0")}/${t.getFullYear() + 543}`;

  // running QT number
  let seq = parseInt(localStorage.getItem("QT_SEQ") || "0", 10);
  seq++;
  localStorage.setItem("QT_SEQ", seq);
  document.getElementById("qtNo").value = "QT-" + String(seq).padStart(4, "0");

  window.addEventListener("beforeprint", buildPrintPages);
  window.addEventListener("afterprint", cleanupPrintPages);
});

</script>

</script>

</body>
</html>




