<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏¢‡∏≤ (‡∏Ç‡∏¢.9)</title>

  <style>
    body {
      font-family: "TH SarabunPSK", system-ui, sans-serif;
      margin: 0;
      padding: 16px;
      background: #f5f5f5;
    }

    .page {
      max-width: 1000px;
      margin: 0 auto;
      background: #fff;
      padding: 16px 24px 32px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }

    /* ‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô */
    .top-buttons {
      display: flex;
      gap: 10px;
      justify-content: flex-end;
      margin-bottom: 20px;
    }
    .btn {
      padding: 10px 18px;
      border-radius: 30px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      border: none;
      color: white;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    .btn-ky9-list { background:#00c853; }
    .btn-ky9-form { background:#009688; }
    .btn-ky11    { background:#1976d2; }
    .btn-print   { background:#ff9800; }
    .btn-download{ background:#9c27b0; }

    /* ‡∏´‡∏±‡∏ß‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© */
    h1, h2 {
      text-align: center;
      margin: 0;
      line-height: 1.2;
    }

    .header-box {
      background:#ffe0b2;
      padding:6px;
      margin-top:10px;
      text-align:center;
      font-size:1rem;
    }

    /* ‡∏ï‡∏≤‡∏£‡∏≤‡∏á */
    .table-wrapper {
      border:3px solid #00c853;
      margin-top:20px;
    }
    table {
      width:100%;
      border-collapse: collapse;
      font-size:0.9rem;
    }
    th {
      background:#00c853;
      color:white;
      border:1px solid #555;
      text-align:center;
      padding:4px;
    }
    td {
      border:1px solid #555;
      padding:4px;
      white-space:nowrap;
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ‡∏ü‡∏≠‡∏£‡πå‡∏° */
    th:nth-child(1), td:nth-child(1) { width:40px; }
    th:nth-child(2), td:nth-child(2) { width:80px; }
    th:nth-child(3), td:nth-child(3) { width:180px; } /* ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢ */
    th:nth-child(4), td:nth-child(4) { width:180px; } /* ‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡∏≤ */
    th:nth-child(5), td:nth-child(5) { width:120px; } /* ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ú‡∏•‡∏¥‡∏ï */
    th:nth-child(6), td:nth-child(6) { width:60px;  text-align:center;}
    th:nth-child(7), td:nth-child(7) { width:60px;  text-align:center;}
    th:nth-child(8), td:nth-child(8) { width:140px; }
    th:nth-child(9), td:nth-child(9) { width:100px; }

    @media print {
      .top-buttons { display:none; }
      body { padding:0; background:white; }
      .page { box-shadow:none; padding:0 8mm; }
    }
  </style>
</head>

<body>
<div class="page">

  <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏ö‡∏ô -->
  <div class="top-buttons">
    <a href="./ky9.html"><button class="btn btn-ky9-list">‡∏Ç‡∏¢.9 (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö)</button></a>
    <a href="./ky9-form.html"><button class="btn btn-ky9-form">‡∏Ç‡∏¢.9 (‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°)</button></a>
    <a href="./ky11.html"><button class="btn btn-ky11">‡∏Ç‡∏¢.11</button></a>
    <button class="btn btn-print" onclick="window.print()">üñ® ‡∏û‡∏¥‡∏°‡∏û‡πå</button>
    <button class="btn btn-download" onclick="window.print()">‚¨á PDF</button>
  </div>

  <h1>‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏¢‡∏≤</h1>
  <h2>‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢‡∏¢‡∏≤ <span contenteditable="true">‡∏Ñ‡∏•‡∏±‡∏á‡∏¢‡∏≤‡∏î‡∏µ‡∏î‡∏µ</span></h2>

  <div class="header-box">
    ‡πÅ‡∏™‡∏ô‡∏™‡∏∏‡∏Ç <span contenteditable="true">123 ‡∏ñ‡∏ô‡∏ô ‡∏Ç‡πâ‡∏≤‡∏ß‡∏´‡∏•‡∏≤‡∏° ‡∏ï‡∏≥‡∏ö‡∏• ‡∏ö‡πâ‡∏≤‡∏ô‡∏õ‡∏∂‡∏Å ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ 20000</span>
    ‡πÇ‡∏ó‡∏£. <span contenteditable="true">098 444 1614</span>
  </div>

  <div style="text-align:right; font-size:0.9rem; margin-top:4px;">‡πÅ‡∏ö‡∏ö ‡∏Ç‡∏¢.9</div>

  <div id="status" style="color:#777; font-size:0.85rem;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet‚Ä¶</div>

  <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á -->
  <div class="table-wrapper">
    <table>
      <thead>
      <tr>
        <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà</th>
        <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö</th>
        <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢</th>
        <th>‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡∏≤</th>
        <th>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ú‡∏•‡∏¥‡∏ï</th>
        <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
        <th>‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
        <th>‡∏•‡∏≤‡∏¢‡∏°‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥</th>
        <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
      </tr>
      </thead>

      <tbody id="formBody">
      </tbody>
    </table>
  </div>

</div>

<script>
const SPREADSHEET_ID ="1Fqq6zxoM8Qw-hNbl5U7hwmezdzxT32ek43qX70uQAZc";
const GID ="136320859";
const URL =`https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:json&gid=${GID}`;

async function loadSheet(){
  const tbody=document.getElementById("formBody");
  const status=document.getElementById("status");

  try{
    const res=await fetch(URL);
    const t=await res.text();
    const jsonStr=t.substring(t.indexOf("{"),t.lastIndexOf("}")+1);
    const data=JSON.parse(jsonStr);
    const rows=data.table.rows;

    tbody.innerHTML="";

    rows.forEach(r=>{
      const c=r.c||[];
      const no=c[0]?.v||"";
      const date=c[1]?.f||c[1]?.v||"";
      const vendor=c[2]?.v||"";
      const drug=c[4]?.v||"";   // ‚≠ê ‡∏Ç‡πâ‡∏≤‡∏° ITEMCODE (c[3])
      const lot=c[5]?.v||"";
      const qty=c[6]?.v||"";
      const unit=c[7]?.v||"";
      const signer=c[8]?.v||"";
      const remark=c[9]?.v||"";

      if(!drug && !lot && !vendor) return;

      tbody.innerHTML+=`
      <tr>
        <td>${no}</td>
        <td>${date}</td>
        <td>${vendor}</td>
        <td>${drug}</td>
        <td>${lot}</td>
        <td style="text-align:center">${qty}</td>
        <td style="text-align:center">${unit}</td>
        <td>${signer}</td>
        <td>${remark}</td>
      </tr>`;
    });

    status.textContent="‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
  } 
  catch(e){
    status.textContent="‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
  }
}

loadSheet();
</script>

</body>
</html>
