<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏¢‡∏≤ (‡∏Ç‡∏¢.9)</title>
  <style>
    body {
      font-family: "TH SarabunPSK", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 16px;
      background: #f5f5f5;
    }
    .page {
      max-width: 1000px;
      margin: 0 auto;
      background: #fff;
      padding: 16px 24px 32px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }

    /* ‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô */
    .top-buttons {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      justify-content: flex-end;
    }
    .top-buttons .btn {
      display: inline-block;
      padding: 10px 18px;
      border-radius: 30px;
      text-decoration: none;
      font-size: 1rem;
      font-weight: 600;
      border: none;
      cursor: pointer;
      box-shadow: 0 3px 6px rgba(0,0,0,0.15);
      transition: 0.15s;
    }
    .btn-ky9-list  { background: #00c853; color: #fff; }
    .btn-ky9-form  { background: #009688; color: #fff; }
    .btn-ky11      { background: #1976d2; color: #fff; }
    .btn-print     { background: #ff9800; color: #fff; }
    .btn-download  { background: #9c27b0; color: #fff; }
    .top-buttons .btn:hover {
      opacity: 0.85;
      transform: translateY(-2px);
    }

    h1,h2 {
      margin: 0;
      text-align: center;
      line-height: 1.2;
    }
    h1 { font-size: 1.4rem; }
    h2 { font-size: 1.2rem; }

    .header-box {
      margin-top: 8px;
      margin-bottom: 8px;
      background: #ffe0b2;
      padding: 6px;
    }
    .header-line {
      text-align: center;
      font-size: 0.95rem;
    }

    /* ‡∏™‡πà‡∏ß‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô/‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ */
    .editable {
      border-bottom: 1px dotted #555;
      padding: 0 2px;
      min-width: 80px;
      display: inline-block;
    }

    .sheet-label {
      text-align: right;
      font-size: 0.9rem;
      margin-top: 4px;
      color: #555;
    }

    .table-wrapper {
      margin-top: 8px;
      border: 3px solid #00c853;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.85rem;
    }
    thead {
      background: #00c853;
      color: #fff;
    }
    th, td {
      border: 1px solid #666;
      padding: 4px 4px;
      text-align: left;
      vertical-align: top;
      white-space: nowrap;
    }
    th:nth-child(1), td:nth-child(1) { width: 40px; text-align: center; }
    th:nth-child(2), td:nth-child(2) { width: 80px; text-align: center; }
    th:nth-child(3), td:nth-child(3) { width: 160px; }
    th:nth-child(4), td:nth-child(4) { width: 80px; }
    th:nth-child(5), td:nth-child(5) { width: 160px; }
    th:nth-child(6), td:nth-child(6) { width: 120px; }
    th:nth-child(7), td:nth-child(7) { width: 80px; text-align: center; }
    th:nth-child(8), td:nth-child(8) { width: 60px; text-align: center; }
    th:nth-child(9), td:nth-child(9) { width: 140px; }
    th:nth-child(10), td:nth-child(10) { width: 100px; }

    .info-line {
      font-size: 0.9rem;
      margin-top: 4px;
      color: #777;
    }

    @media print {
      body {
        background: #fff;
        padding: 0;
      }
      .page {
        box-shadow: none;
        margin: 0;
        padding: 0 8mm;
      }
      .top-buttons { display: none; } /* ‡∏ã‡πà‡∏≠‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏≠‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå */
      .info-line { display: none; }
    }
  </style>
</head>
<body>
  <div class="page">
    <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏±‡∏î -->
    <div class="top-buttons">
      <a href="./ky9.html" class="btn btn-ky9-list">‡∏Ç‡∏¢.9 (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö)</a>
      <a href="./ky9-form.html" class="btn btn-ky9-form">‡∏Ç‡∏¢.9 (‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°)</a>
      <a href="./ky11.html" class="btn btn-ky11">‡∏Ç‡∏¢.11 (‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏¢‡∏≤)</a>

      <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå -->
      <button class="btn btn-print" onclick="window.print()">üñ® ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</button>

      <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF (‡πÉ‡∏ä‡πâ Save as PDF ‡∏ï‡∏≠‡∏ô Print) -->
      <button class="btn btn-download" onclick="downloadPDF()">‚¨á ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF</button>
    </div>

    <!-- ‡∏´‡∏±‡∏ß‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© -->
    <h1>‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏¢‡∏≤</h1>
    <h2>‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢‡∏¢‡∏≤ <span class="editable" contenteditable="true">‡∏Ñ‡∏•‡∏±‡∏á‡∏¢‡∏≤‡∏î‡∏µ‡∏î‡∏µ</span></h2>

    <div class="header-box">
      <div class="header-line">
        ‡πÅ‡∏™‡∏ô‡∏™‡∏∏‡∏Ç <span class="editable" contenteditable="true">123 ‡∏ñ‡∏ô‡∏ô ‡∏Ç‡πâ‡∏≤‡∏ß‡∏´‡∏•‡∏≤‡∏° ‡∏ï‡∏≥‡∏ö‡∏• ‡∏ö‡πâ‡∏≤‡∏ô‡∏õ‡∏∂‡∏Å ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ 20000</span>
        ‡πÇ‡∏ó‡∏£. <span class="editable" contenteditable="true">098 444 1614</span>
      </div>
    </div>

    <div class="sheet-label">‡πÅ‡∏ö‡∏ö ‡∏Ç‡∏¢.9</div>
    <div id="status" class="info-line">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet ‡∏Ç‡∏¢.9 ‚Ä¶</div>

    <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å‡πÅ‡∏ö‡∏ö‡πÉ‡∏ô‡∏ä‡∏µ‡∏ï -->
    <div class="table-wrapper">
      <table>
        <thead>
          <tr>
            <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà</th>
            <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
            <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢</th>
            <th>ITEMCODE</th>
            <th>‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡∏≤</th>
            <th>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏ú‡∏•‡∏¥‡∏ï</th>
            <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô/‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì</th>
            <th>‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
            <th>‡∏•‡∏≤‡∏¢‡∏°‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£</th>
            <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
          </tr>
        </thead>
        <tbody id="formBody">
          <!-- ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏ï‡∏¥‡∏°‡∏î‡πâ‡∏ß‡∏¢ JS ‡∏à‡∏≤‡∏Å Google Sheet ‡∏Ç‡∏¢9 -->
        </tbody>
      </table>
    </div>

  </div>

  <script>
    function downloadPDF() {
      // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö GitHub Pages ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ Print ‡πÅ‡∏•‡πâ‡∏ß Save as PDF
      window.print();
    }

    // ==== ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet ‡∏Ç‡∏¢.9 ‡∏°‡∏≤‡πÉ‡∏™‡πà‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏° ====
    const SPREADSHEET_ID = "1Fqq6zxoM8Qw-hNbl5U7hwmezdzxT32ek43qX70uQAZc";
    const GID = "136320859";
    const SHEET_URL =
      `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:json&gid=${GID}`;

    async function loadKy9Form() {
      const statusEl = document.getElementById("status");
      const tbody = document.getElementById("formBody");

      try {
        const res = await fetch(SHEET_URL);
        const text = await res.text();

        const jsonStr = text.substring(text.indexOf("{"), text.lastIndexOf("}") + 1);
        const data = JSON.parse(jsonStr);
        const rows = data.table.rows || [];

        tbody.innerHTML = "";

        rows.forEach((row) => {
          const c = row.c || [];

          // map ‡∏ï‡∏≤‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏µ‡∏ï ‡∏Ç‡∏¢9
          const no        = c[0]?.v ?? "";
          const dateIn    = c[1]?.f || c[1]?.v || "";
          const vendor    = c[2]?.v ?? "";
          const itemCode  = c[3]?.v ?? "";
          const drugName  = c[4]?.v ?? "";
          const lot       = c[5]?.v ?? "";
          const qty       = c[6]?.v ?? "";
          const unit      = c[7]?.v ?? "";
          const signer    = c[8]?.v ?? "";
          const remark    = c[9]?.v ?? "";

          // ‡∏ñ‡πâ‡∏≤‡πÅ‡∏ñ‡∏ß‡∏ß‡πà‡∏≤‡∏á‡∏°‡∏≤‡∏Å ‡πÜ ‡∏Ç‡πâ‡∏≤‡∏°
          if (!itemCode && !drugName && !lot && !vendor) return;

          const tr = document.createElement("tr");

          function addCell(text, alignCenter = false) {
            const td = document.createElement("td");
            td.textContent = text;
            if (alignCenter) td.style.textAlign = "center";
            tr.appendChild(td);
          }

          addCell(no, true);
          addCell(dateIn, true);
          addCell(vendor);
          addCell(itemCode);
          addCell(drugName);
          addCell(lot);
          addCell(qty, true);
          addCell(unit, true);
          addCell(signer);
          addCell(remark);

          tbody.appendChild(tr);
        });

        if (rows.length === 0) {
          statusEl.textContent = "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Google Sheet ‡∏Ç‡∏¢.9";
        } else {
          statusEl.textContent = "‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet ‡∏Ç‡∏¢.9 ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß";
        }
      } catch (err) {
        console.error(err);
        statusEl.textContent = "‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå / SPREADSHEET_ID / gid";
      }
    }

    document.addEventListener("DOMContentLoaded", loadKy9Form);
  </script>
</body>
</html>
