<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏¢‡∏≤ (‡∏Ç‡∏¢.9)</title>

  <style>
    body {
      font-family: "TH SarabunPSK", system-ui, sans-serif;
      margin: 0;
      padding: 16px;
      background: #f5f5f5;
    }

    .page {
      max-width: 1000px;
      margin: 0 auto;
      background: #fff;
      padding: 16px 24px 32px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }

    /* ‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô */
    .top-buttons {
      display: flex;
      gap: 10px;
      justify-content: flex-end;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    .btn {
      padding: 10px 18px;
      border-radius: 30px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      border: none;
      color: white;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    .btn-ky9-list { background:#00c853; }
    .btn-ky9-form { background:#009688; }
    .btn-ky11    { background:#1976d2; }
    .btn-print   { background:#ff9800; }
    .btn-download{ background:#9c27b0; }

    /* ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å */
    .table-wrapper {
      border:3px solid #00c853;
    }
    table {
      width:100%;
      border-collapse: collapse;
      font-size:0.9rem;
    }
    th, td {
      border:1px solid #555;
      padding:4px;
      white-space:nowrap;
      vertical-align:top;
    }

    /* ‡∏´‡∏±‡∏ß‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© (row ‡πÉ‡∏ô thead) */
    .title-row th {
      border:none;
      text-align:center;
      font-size:1.4rem;
      padding-top:8px;
      padding-bottom:0;
    }
    .shop-row th {
      border:none;
      text-align:center;
      font-size:1.2rem;
      padding-top:0;
      padding-bottom:0;
    }
    .addr-row th {
      border:none;
      text-align:center;
      background:#ffe0b2;
      font-size:0.95rem;
      padding-top:4px;
      padding-bottom:4px;
    }
    .label-row th {
      border:none;
      font-size:0.9rem;
      padding-top:2px;
      padding-bottom:4px;
    }
    .label-row th:first-child {
      text-align:left;
    }
    .label-row th:last-child {
      text-align:right;
    }

    .editable {
      border-bottom:1px dotted #555;
      padding:0 2px;
      min-width:80px;
      display:inline-block;
    }

    /* ‡∏´‡∏±‡∏ß‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå */
    .header-row th {
      background:#00c853;
      color:#fff;
      text-align:center;
      border:1px solid #555;
      padding-top:4px;
      padding-bottom:4px;
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ‡∏Å‡∏±‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° */
    .header-row th:nth-child(1), td:nth-child(1) { width:40px;  text-align:center; }
    .header-row th:nth-child(2), td:nth-child(2) { width:80px;  text-align:center; }
    .header-row th:nth-child(3), td:nth-child(3) { width:180px; }
    .header-row th:nth-child(4), td:nth-child(4) { width:180px; }
    .header-row th:nth-child(5), td:nth-child(5) { width:120px; }
    .header-row th:nth-child(6), td:nth-child(6) { width:60px;  text-align:center; }
    .header-row th:nth-child(7), td:nth-child(7) { width:60px;  text-align:center; }
    .header-row th:nth-child(8), td:nth-child(8) { width:140px; }
    .header-row th:nth-child(9), td:nth-child(9) { width:100px; }

    #status {
      font-size:0.85rem;
      color:#777;
      margin:8px 0;
    }

    @media print {
      body {
        padding:0;
        background:white;
      }
      .page {
        box-shadow:none;
        margin:0;
        padding:0 8mm;
      }
      .top-buttons { display:none; }

      /* ‡πÉ‡∏´‡πâ‡∏´‡∏±‡∏ß‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© (thead) ‡∏ã‡πâ‡∏≥‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πâ‡∏≤ */
      thead { display: table-header-group; }
      tfoot { display: table-footer-group; }
    }
  </style>
</head>

<body>
<div class="page">

  <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô -->
  <div class="top-buttons">
    <a href="./ky9.html"><button class="btn btn-ky9-list">‡∏Ç‡∏¢.9 (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö)</button></a>
    <a href="./ky9-form.html"><button class="btn btn-ky9-form">‡∏Ç‡∏¢.9 (‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°)</button></a>
    <a href="./ky11.html"><button class="btn btn-ky11">‡∏Ç‡∏¢.11</button></a>
    <button class="btn btn-print" onclick="window.print()">üñ® ‡∏û‡∏¥‡∏°‡∏û‡πå</button>
    <button class="btn btn-download" onclick="window.print()">‚¨á PDF</button>
  </div>

  <div id="status">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet‚Ä¶</div>

  <div class="table-wrapper">
    <table>
      <thead>
        <!-- ‡∏´‡∏±‡∏ß‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© (‡∏à‡∏∞‡∏ã‡πâ‡∏≥‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡∏•‡∏≤ print) -->
        <tr class="title-row">
          <th colspan="9">‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏¢‡∏≤</th>
        </tr>
        <tr class="shop-row">
          <th colspan="9">
            ‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢‡∏¢‡∏≤
            <span class="editable" contenteditable="true">‡∏Ñ‡∏•‡∏±‡∏á‡∏¢‡∏≤‡∏î‡∏µ‡∏î‡∏µ</span>
          </th>
        </tr>
        <tr class="addr-row">
          <th colspan="9">
            ‡πÅ‡∏™‡∏ô‡∏™‡∏∏‡∏Ç
            <span class="editable" contenteditable="true">123 ‡∏ñ‡∏ô‡∏ô ‡∏Ç‡πâ‡∏≤‡∏ß‡∏´‡∏•‡∏≤‡∏° ‡∏ï‡∏≥‡∏ö‡∏• ‡∏ö‡πâ‡∏≤‡∏ô‡∏õ‡∏∂‡∏Å ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ 20000</span>
            ‡πÇ‡∏ó‡∏£.
            <span class="editable" contenteditable="true">098 444 1614</span>
          </th>
        </tr>
        <tr class="label-row">
          <th colspan="9">
            <!-- ‡∏ã‡πâ‡∏≤‡∏¢‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏ß‡πâ / ‡∏Ç‡∏ß‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° -->
            <span style="float:right;">‡πÅ‡∏ö‡∏ö ‡∏Ç‡∏¢.9</span>
          </th>
        </tr>

        <!-- ‡∏´‡∏±‡∏ß‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏´‡∏•‡∏±‡∏Å -->
        <tr class="header-row">
          <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà</th>
          <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö</th>
          <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢</th>
          <th>‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡∏≤</th>
          <th>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ú‡∏•‡∏¥‡∏ï</th>
          <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
          <th>‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
          <th>‡∏•‡∏≤‡∏¢‡∏°‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥</th>
          <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
        </tr>
      </thead>

      <tbody id="formBody">
        <!-- JS ‡∏à‡∏∞‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet -->
      </tbody>
    </table>
  </div>
</div>

<script>
const SPREADSHEET_ID ="1Fqq6zxoM8Qw-hNbl5U7hwmezdzxT32ek43qX70uQAZc";
const GID ="136320859";
const URL =`https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:json&gid=${GID}`;

async function loadSheet(){
  const tbody=document.getElementById("formBody");
  const status=document.getElementById("status");

  try{
    const res=await fetch(URL);
    const t=await res.text();
    const jsonStr=t.substring(t.indexOf("{"),t.lastIndexOf("}")+1);
    const data=JSON.parse(jsonStr);
    const rows=data.table.rows;

    tbody.innerHTML="";

    rows.forEach(r=>{
      const c=r.c||[];
      const no    = c[0]?.v || "";
      const date  = c[1]?.f || c[1]?.v || "";
      const vendor= c[2]?.v || "";
      const drug  = c[4]?.v || "";   // ‡∏Ç‡πâ‡∏≤‡∏° ITEMCODE (c[3])
      const lot   = c[5]?.v || "";
      const qty   = c[6]?.v || "";
      const unit  = c[7]?.v || "";
      const sign  = c[8]?.v || "";
      const remark= c[9]?.v || "";

      if(!vendor && !drug && !lot) return;

      const tr=document.createElement("tr");
      function cell(text, center=false){
        const td=document.createElement("td");
        td.textContent=text;
        if(center) td.style.textAlign="center";
        tr.appendChild(td);
      }

      cell(no,true);
      cell(date,true);
      cell(vendor);
      cell(drug);
      cell(lot);
      cell(qty,true);
      cell(unit,true);
      cell(sign);
      cell(remark);

      tbody.appendChild(tr);
    });

    status.textContent="‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
  }catch(e){
    console.error(e);
    status.textContent="‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
  }
}

loadSheet();
</script>

</body>
</html>
